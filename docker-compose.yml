version: '3.8'

services:
  fretes-api:
    # IMPORTANTE: Altere a URL abaixo para o endereço do seu repositório no GitHub.
    # O Portainer usará isso para baixar e construir a API automaticamente.
    # O '#main' no final especifica o branch. Mude se você usar um branch diferente (ex: #master).
    build:
      context: https://github.com/henriquesergio1/Fretes.git#main
      dockerfile: api/Dockerfile
    container_name: fretes-api
    restart: unless-stopped
    ports:
      # Mapeia a porta 3000 do container para a porta 3030 do seu servidor.
      # Se a porta 3030 já estiver em uso no seu servidor, mude o primeiro número (ex: "3031:3000").
      - "3030:3000"
    
    # --- CONFIGURAÇÃO OBRIGATÓRIA ---
    # As variáveis de ambiente (senhas, etc.) serão configuradas diretamente no Portainer.
    # Deixe esta seção como está.
    environment:
      # Configurações da API
      - API_PORT=3000

      # Conexão com o Banco de Dados Principal (ODIN)
      - DB_SERVER_ODIN=${DB_SERVER_ODIN}
      - DB_DATABASE_ODIN=${DB_DATABASE_ODIN}
      - DB_USER_ODIN=${DB_USER_ODIN}
      - DB_PASSWORD_ODIN=${DB_PASSWORD_ODIN}

      # Conexão com o Banco de Dados de Consulta (ERP)
      - DB_SERVER_ERP=${DB_SERVER_ERP}
      - DB_DATABASE_ERP=${DB_DATABASE_ERP}
      - DB_USER_ERP=${DB_USER_ERP}
      - DB_PASSWORD_ERP=${DB_PASSWORD_ERP}